(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-detail-video-detail-video"],{"0a8c":function(t,e,i){"use strict";(function(t){var n=i("ee27");i("4e82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("f3f3")),s=n(i("326e")),o=n(i("1144")),u=n(i("fd9d")),l=n(i("baa0")),r=n(i("64b0")),c=i("2f62"),d=null,f={components:{mediaList:u.default,fPopup:l.default,detailVideoInfo:s.default,uniNavBar:o.default},data:function(){return{id:0,activeIndex:0,tabIndex:0,tabBars:[{name:"简介"},{name:"评论"}],src:"",poster:"",detail:{created_time:0,id:22,title:"",cover:"",category_id:11,user_id:15,duration:0,desc:"描述",play_count:0,danmu_count:0,user:{id:15,username:"",nickname:"",avatar:""}},scrollH:500,hot:[],videoList:[],followStatus:!1,favaStatus:!1,comments:[],msg:"",reply_id:0,reply_user:{id:0,name:""},fensCount:0}},mounted:function(){d=uni.createVideoContext("myVideo",this)},onLoad:function(t){var e=this,i=uni.getSystemInfoSync();this.scrollH=i.windowHeight-226,this.id=t.id,this.$H.get("/video_read/"+this.id,{token:!0,noJump:!0,toast:!1}).then((function(t){e.hot=t.hot,e.detail=t.video,e.detail.created_time=r.default.gettime(e.detail.created_time),e.poster=e.detail.cover,e.videoList=t.video.video_details||[],e.src=e.videoList[e.activeIndex].url||"",uni.$emit("video",{event:"init",params:{videos:e.videoList,activeIndex:e.activeIndex,poster:e.detail.cover}}),e.followStatus=t.follow,e.favaStatus=t.fava,e.getComments(),e.getUserInfo()}))},computed:(0,a.default)({},(0,c.mapState)({user_id:function(t){return t.user?t.user.id:0}})),methods:{movehandle:function(){},stop:function(){},changeTab:function(t){this.tabIndex=t},openPopup:function(){this.$refs.popup.show()},hidePopup:function(){this.$refs.popup.hide()},openComment:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:0,username:"",nickname:""};this.reply_id=t,this.reply_user={id:e.id,name:e.nickname||e.username},this.msg="",this.$refs.comment.show()},checkVideo:function(t,e){this.activeIndex=e,this.src=t.url||"",d.pause()},doFollow:function(){var e=this,i=this.followStatus?"/user/unfollow":"/user/follow",n=this.followStatus?"取消关注":"关注";this.$H.post(i,{follow_id:this.detail.user.id},{token:!0}).then((function(i){e.followStatus=!e.followStatus,uni.showToast({title:n+"成功",icon:"none"}),t.log(i)})).catch((function(e){t.log(e)}))},doFava:function(){var t=this;this.$H.post("/fava/video",{video_id:this.detail.id},{token:!0}).then((function(e){t.favaStatus=e.status,uni.showToast({title:e.msg,icon:"none"})}))},getComments:function(){var t=this;this.$H.get("/video_comment/"+this.detail.id).then((function(e){t.comments=e.sort((function(t,e){return t.created_time-e.created_time})),t.scrollinto="pinglun"+t.commentId}))},sendComment:function(){var t=this,e=uni.getStorageSync("token");if(e){if(""===this.msg)return uni.showToast({title:"评论内容不能为空",icon:"none"});this.$H.post("/comment",{content:this.msg,video_id:this.detail.id,reply_id:this.reply_id,reply_user_id:this.reply_user.id},{token:!0}).then((function(e){t.getComments(),uni.showToast({title:"评论成功",icon:"none"}),t.$refs.comment.hide()}))}else uni.showToast({title:"请登录",icon:"none",duration:500}),setTimeout((function(){uni.navigateTo({url:"/pages/login/login"})}),1e3)},getUserInfo:function(){var t=this;this.$H.get("/user/user_info?user_id="+this.detail.user.id).then((function(e){t.fensCount=e.fensCount}))},goBack:function(){t.log(1),uni.navigateBack({delta:1})}},filters:{formatTime:function(t){return r.default.gettime(t)}}};e.default=f}).call(this,i("5a52")["default"])},"326e":function(t,e,i){"use strict";i.r(e);var n=i("3c62"),a=i("ab5d");for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);var o,u=i("f0c5"),l=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,"7f56c588",null,!1,n["a"],o);e["default"]=l.exports},"3c62":function(t,e,i){"use strict";var n,a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticClass:"py-2 pl-3 flex align-center"},[i("v-uni-image",{staticClass:"mr-3 rounded-circle",staticStyle:{width:"80rpx",height:"80rpx"},attrs:{src:t.detail.user.avatar||"/static/title.jpg"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openUserSpace.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"flex flex-column"},[i("v-uni-text",{staticClass:"text-main font-md"},[t._v(t._s(t.detail.user.nickname||t.detail.user.username))]),i("v-uni-text",{staticClass:"font-sm text-muted",staticStyle:{"line-height":"1"}},[t._v(t._s(this.fensCount)+" 粉丝")])],1),i("v-uni-view",{staticClass:"ml-auto flex"},[t.detail.user.id!==t.user_id?i("v-uni-view",{staticClass:" flex align-center justify-center rounded  text-white py-1 px-2 mr-2",class:t.followStatus?"bg-main":"bg-main-hover",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$emit("doFollow")}}},[i("v-uni-text",{staticClass:"font ",staticStyle:{width:"100upx","text-align":"center"}},[t._v(t._s(t.followStatus?"已关注":"关注"))])],1):t._e()],1)],1),i("v-uni-view",[t.detail.user.id!==t.user_id?i("v-uni-view",{staticClass:"pt-1",staticStyle:{float:"right"}},[i("v-uni-view",{staticClass:"flex flex-column align-center px-3 ",class:t.favaStatus?"text-main":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doFava.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"iconfont iconshoucang ",staticStyle:{"font-size":"40upx","line-height":"40upx"}}),i("v-uni-text",{staticStyle:{width:"100upx","text-align":"center"}},[t._v(t._s(t.favaStatus?"已收藏":"收藏"))])],1)],1):t._e(),i("v-uni-view",[i("v-uni-view",{staticClass:"font-md px-3"},[t._v(t._s(t.detail.title))]),i("v-uni-view",{staticClass:"flex align-center text-muted px-3"},[i("v-uni-text",{staticClass:"iconfont iconbofangshu font-md mr-1"}),i("v-uni-text",{staticClass:"font-sm"},[t._v(t._s(t.detail.play_count+1))]),i("v-uni-text",{staticClass:"iconfont icondanmushu font-md mx-1"}),i("v-uni-text",{staticClass:"font-sm"},[t._v(t._s(t.detail.danmu_count))]),i("v-uni-text",{staticClass:"font-sm ml-1"},[t._v(t._s(t.detail.created_time))])],1)],1)],1)],1)},s=[];i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}))},4301:function(t,e,i){"use strict";var n,a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[t.status?i("v-uni-view",{staticClass:"position-fixed top-0 left-0 right-0 bottom-0 animated faster fadeIn",staticStyle:{"background-color":"rgba(0,0,0,0.3)","z-index":"1000"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.hide.apply(void 0,arguments)}}},[t._t("default")],2):t._e()],1)},s=[];i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}))},"4cd5":function(t,e,i){"use strict";i.r(e);var n=i("aec4"),a=i("e3fe");for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);var o,u=i("f0c5"),l=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,"5f849de8",null,!1,n["a"],o);e["default"]=l.exports},"64b0":function(t,e,i){"use strict";i("d3b7"),i("e25e"),i("4d63"),i("ac1f"),i("25f0"),i("5319"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={getHoroscope:function(t){var e=["摩羯","水瓶","双鱼","白羊","金牛","双子","巨蟹","狮子","处女","天秤","天蝎","射手","摩羯"];t=new Date(t);var i=t.getMonth()+1,n=t.getDate(),a=i-(n-14<"865778999988".charAt(i));return e[a]+"座"},sumAge:function(t){var e=new Date(t.replace(/-/g,"/")),i=new Date,n=i.getTime()-e.getTime(),a=Math.floor(n/864e5),s=n%864e5,o=Math.floor(s/36e5),u=s%36e5,l=(Math.floor(u/6e4),u%6e4);Math.round(l/1e3);return a+"天 "+o+"小时 "},getChatTime:function(t,e){if(t=t.toString().length<13?1e3*t:t,e=e.toString().length<13?1e3*e:e,(parseInt(t)-parseInt(e))/1e3>300)return this.gettime(t)},gettime:function(t){t=t.toString().length<13?1e3*t:t;var e=(new Date).getTime(),i=(e-parseInt(t))/1e3;return i<43200?this.dateFormat(new Date(t),"{A} {t}:{ii}"):i<518400?this.dateFormat(new Date(t),"{Mon}月{DD}日 {A} {t}:{ii}"):this.dateFormat(new Date(t),"{Y}-{MM}-{DD} {A} {t}:{ii}")},parseNumber:function(t){return t<10?"0"+t:t},dateFormat:function(t,e){var i={},n=/\{([^}]+)\}/,a=["1","2","3","4","5","6","7","8","9","10","11","12"];i["Y"]=t.getFullYear(),i["M"]=t.getMonth()+1,i["MM"]=this.parseNumber(i["M"]),i["Mon"]=a[i["M"]-1],i["D"]=t.getDate(),i["DD"]=this.parseNumber(i["D"]),i["h"]=t.getHours(),i["hh"]=this.parseNumber(i["h"]),i["t"]=i["h"]>12?i["h"]-12:i["h"],i["tt"]=this.parseNumber(i["t"]),i["A"]=i["h"]>12?"下午":"上午",i["i"]=t.getMinutes(),i["ii"]=this.parseNumber(i["i"]),i["s"]=t.getSeconds(),i["ss"]=this.parseNumber(i["s"]);while(n.test(e))e=e.replace(n,i[RegExp.$1]);return e},getAgeByBirthday:function(t){var e=new Date(t.replace(/-/g,"/")),i=new Date;return i.getFullYear()-e.getFullYear()-(i.getMonth()<e.getMonth()||i.getMonth()==e.getMonth()&&i.getDate()<e.getDate()?1:0)}};e.default=n},"9dab":function(t,e,i){"use strict";(function(t){var n=i("ee27");i("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("f3f3")),s=i("2f62"),o={props:{detail:Object,followStatus:Boolean,favaStatus:Boolean,fensCount:Number},computed:(0,a.default)({},(0,s.mapState)({user_id:function(t){return t.user?t.user.id:0}})),onLoad:function(){t.log(this.favaStatus)},methods:{doFava:function(){this.$emit("doFava")},openUserSpace:function(){uni.navigateTo({url:"../../pages/user-space/user-space?user_id="+this.detail.user.id})}}};e.default=o}).call(this,i("5a52")["default"])},ab5d:function(t,e,i){"use strict";i.r(e);var n=i("9dab"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},aec4:function(t,e,i){"use strict";var n,a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"animated fadeIn",staticStyle:{"line-height":"1","overflow-y":"hidden"}},[i("v-uni-view",{staticClass:"position-absolute iconfont iconfanhui ml-1",staticStyle:{"z-index":"999",color:"#FFFFFF","font-size":"50upx"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.goBack.apply(void 0,arguments)}}}),i("v-uni-video",{staticStyle:{height:"225px",width:"750rpx"},attrs:{src:t.src,poster:t.poster,controls:!0,id:"myVideo"}}),i("v-uni-scroll-view",{style:"height:"+t.scrollH+"px;",attrs:{"scroll-y":"true"}},[i("v-uni-view",{staticClass:"border-bottom border-light-secondary flex align-stretch bg-white",staticStyle:{height:"80rpx",position:"fixed",left:"0",right:"0","z-index":"100"}},t._l(t.tabBars,(function(e,n){return i("v-uni-view",{key:n,staticClass:"flex-1 flex align-center justify-center",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeTab(n)}}},[i("v-uni-text",{staticClass:"font py-1",class:t.tabIndex===n?"text-main border-main":"",style:t.tabIndex===n?"border-bottom: 5rpx solid;":""},[t._v(t._s(e.name))])],1)})),1),i("v-uni-view",{staticStyle:{height:"80rpx"}}),0===t.tabIndex?i("v-uni-view",{staticClass:"animated fadeIn fast"},[i("detailVideoInfo",{attrs:{fensCount:t.fensCount,detail:t.detail,followStatus:t.followStatus,favaStatus:t.favaStatus},on:{doFava:function(e){arguments[0]=e=t.$handleEvent(e),t.doFava.apply(void 0,arguments)},doFollow:function(e){arguments[0]=e=t.$handleEvent(e),t.doFollow.apply(void 0,arguments)}}}),t.videoList.length>1?i("v-uni-view",{staticClass:"py-3 border-top border-bottom border-light-secondary",on:{touchmove:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.movehandle.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"flex align-center px-3"},[i("v-uni-text",{staticClass:"font-md"},[t._v("选集")]),i("v-uni-view",{staticClass:"flex align-center text-muted ml-auto",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openPopup.apply(void 0,arguments)}}},[t._v("共"+t._s(t.videoList.length)+"集"),i("v-uni-text",{staticClass:"iconfont iconjinru ml-1"})],1)],1),i("v-uni-scroll-view",{staticClass:"scroll-row mt-2",attrs:{"scroll-x":"true"}},t._l(t.videoList,(function(e,n){return i("v-uni-view",{key:n,staticClass:"scroll-row-item rounded border ml-2 p-2 ",class:t.activeIndex===n?"text-main border-main":"text-muted border-light-secondary",staticStyle:{width:"340rpx"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.checkVideo(e,n)}}},[i("v-uni-text",{staticClass:"font"},[t._v("第 "+t._s(n+1)+" 集")]),i("v-uni-view",{staticClass:"font-md text-ellipsis"},[t._v(t._s(e.title))])],1)})),1)],1):t._e(),i("v-uni-view",{staticClass:"f-list"},t._l(t.hot,(function(t,e){return i("media-list",{key:e,attrs:{item:t,index:e}})})),1)],1):i("v-uni-view",{staticClass:"animated fadeIn fast px-3 py-1"},[t.comments.length?t._e():i("v-uni-view",{staticClass:"text-center text-main mt-4"},[t._v("写下第一条评论吧！")]),t._l(t.comments,(function(e,n){return i("v-uni-view",{key:e.created_time,staticClass:"uni-comment-list ",attrs:{id:"pinglun"+e.id}},[i("v-uni-view",{staticClass:"uni-comment-face"},[i("v-uni-image",{staticClass:"rounded-circle",staticStyle:{width:"80rpx",height:"80rpx"},attrs:{src:e.send_user.avatar||"/static/title.jpg"}})],1),i("v-uni-view",{staticClass:"uni-comment-body"},[i("v-uni-view",{staticClass:"uni-comment-top"},[i("v-uni-text",{staticClass:"font text-main"},[t._v(t._s(e.send_user.nickname||e.send_user.username))])],1),i("v-uni-view",{staticClass:"uni-comment-date"},[i("v-uni-text",{staticClass:"font-sm text-muted"},[t._v(t._s(t._f("formatTime")(e.created_time)))])],1),i("v-uni-view",{staticClass:"uni-comment-content",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openComment(e.id,e.send_user)}}},[t._v(t._s(e.content))]),t._l(e.comments,(function(n,a){return i("v-uni-view",{key:n.created_time,staticClass:"flex flex-wrap p-2 bg-light rounded"},[i("v-uni-text",{staticClass:"font text-main"},[t._v(t._s(n.send_user.nickname||n.send_user.username))]),i("v-uni-text",{staticClass:"font text-dark"},[t._v("回复")]),i("v-uni-text",{staticClass:"font text-main"},[t._v(t._s(n.reply_user.nickname||n.reply_user.username)+"：")]),i("v-uni-text",{on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openComment(e.id,n.send_user)}}},[t._v(t._s(n.content))])],1)}))],2)],1)})),i("v-uni-view",{staticClass:"position-fixed flex align-center justify-center bg-main rounded-circle animated fast",staticStyle:{width:"120rpx",height:"120rpx",right:"50rpx",bottom:"50rpx"},attrs:{"hover-class":"bg-main-hover pulse"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openComment(0)}}},[i("v-uni-text",{staticClass:"text-white iconfont iconjia"})],1)],2)],1),i("f-popup",{ref:"popup"},[i("v-uni-view",{staticClass:"position-absolute bottom-0 left-0 right-0 bg-white animated faster fadeIn",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.stop.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.movehandle.apply(void 0,arguments)}}},[i("v-uni-view",{staticStyle:{height:"600rpx"}},[i("v-uni-view",{staticClass:"flex align-center"},[i("v-uni-text",{staticClass:"font-md ml-3"},[t._v("选集")]),i("v-uni-view",{staticClass:"flex align-center justify-center ml-auto",staticStyle:{width:"80rpx",height:"80rpx"},attrs:{"hover-class":"bg-light"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hidePopup.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"iconfont iconguanbi text-muted"})],1)],1),i("v-uni-scroll-view",{staticStyle:{height:"520rpx"},attrs:{"scroll-y":"true"}},[i("v-uni-view",{staticClass:"flex flex-wrap"},t._l(t.videoList,(function(e,n){return i("v-uni-view",{key:n,staticClass:"p-2",staticStyle:{width:"50%","box-sizing":"border-box"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.checkVideo(e,n)}}},[i("v-uni-view",{staticClass:"rounded border p-2 ",class:t.activeIndex===n?"text-main border-main":"text-muted border-light-secondary"},[i("v-uni-text",{staticClass:"font"},[t._v("第 "+t._s(n+1)+" 集")]),i("v-uni-view",{staticClass:"font-md text-ellipsis"},[t._v(t._s(e.title))])],1)],1)})),1)],1)],1)],1)],1),i("f-popup",{ref:"comment"},[i("v-uni-view",{staticClass:"position-absolute bottom-0 left-0 right-0 bg-white animated faster fadeIn",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.stop.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"flex align-center px-3",staticStyle:{height:"100rpx"}},[i("v-uni-input",{staticClass:"bg-light rounded mr-3 px-2 flex-1",staticStyle:{height:"60rpx"},attrs:{type:"text",placeholder:t.reply_user.id?"回复@"+t.reply_user.name:"说一句话吧"},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}}),i("v-uni-view",{staticClass:"flex align-center justify-center rounded bg-main text-white py px-3 ml-auto",attrs:{"hover-class":"bg-main-hover"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sendComment.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"font"},[t._v("发送")])],1)],1)],1)],1)],1)},s=[];i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}))},baa0:function(t,e,i){"use strict";i.r(e);var n=i("4301"),a=i("bcf4");for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);var o,u=i("f0c5"),l=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,"cf3b264c",null,!1,n["a"],o);e["default"]=l.exports},bcf4:function(t,e,i){"use strict";i.r(e);var n=i("c801"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},c801:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{status:!1}},methods:{show:function(){this.status=!0},hide:function(){this.status=!1},movehandle:function(){}}};e.default=n},e3fe:function(t,e,i){"use strict";i.r(e);var n=i("0a8c"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a}}]);